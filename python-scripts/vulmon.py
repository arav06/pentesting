from bs4 import BeautifulSoup as bs 
from requests import get
from sys import argv as arg

inp = arg[1:]

string = ""

for a in inp:
	string += a + " "

query = string.replace(" ","%20")

if query == "":
	print("\npython3 vulmon.py SOFTWARE-NAME VERSION")
	exit()

i = 1
j = 0

print("\n")

try:
	while True:

		url = f"https://vulmon.com/searchpage?q={query}&sortby=byriskscore&page={i}"
		r = get(url)


		soup = bs(r.content, 'lxml')

		items = soup.find_all('div', class_ = "item")

		if len(items) == 1:
			if j == 0:
				print("Could not find any vulnerabilities :(")
			exit()
		else:
			j += 1
		for item in items:
			try:
				score = item.find('div', class_ = "value").text
				cve = item.find('a', class_ = "header").text.replace("CVE-", "")
				desc = item.find('div', class_ = "description").text
				info = item.find('a', class_ = "header")['href']
				info = "https://vulmon.com"+info
				cveInfo = f"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-{cve}"
				exploitInfo = f"https://www.exploit-db.com/search?cve={cve}"
				googleInfo = f"https://google.com/search?q=CVE-{cve}"
				print(f"\nCVE: {cve}\nScore: {score}\nDescription: {desc}\n\nMore Info: {info}\n\t   {cveInfo}\n\t   {exploitInfo}\n\t   {googleInfo}\n")
				print("-------------------------------------------------------------------------------")
			except:
				continue
		i += 1

except KeyboardInterrupt:
	exit()